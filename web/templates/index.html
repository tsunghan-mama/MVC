<!DOCTYPE html>
<html lang="en">
    <head>
        <title>VFX Final Project: MVC Image Cloning</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <link href="https://unpkg.com/filepond/dist/filepond.css" rel="stylesheet" />
        <link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css" rel="stylesheet"/>
        <script src="https://unpkg.com/konva@8.0.4/konva.min.js"></script>
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='main.css') }}">
        <script language="javascript" type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <!-- <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='upload.css') }}"> -->
    </head>
    <body onload="clear_canvas()">
        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
        <script src="https://unpkg.com/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.js"></script>
        <script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"></script>
        <script src="https://unpkg.com/filepond-plugin-image-validate-size/dist/filepond-plugin-image-validate-size.js"></script>
        <script src="https://unpkg.com/filepond-plugin-image-exif-orientation/dist/filepond-plugin-image-exif-orientation.js"></script>
        <script src="https://unpkg.com/filepond/dist/filepond.js"></script>
        <script type="text/javascript" src="{{ url_for('static', filename='main.js') }}"></script>
        <!-- <script type="text/javascript" src="{{ url_for('static', filename='upload.js') }}"></script> -->
    <nav class="navbar navbar-expand-md">
        <a class="navbar-brand" href="#">MVC Image Cloning</a>
        <button class="navbar-toggler navbar-dark" type="button" data-toggle="collapse" data-target="#main-navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-navigation">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="#">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">About</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Github Page</a>
                </li>
            </ul>
        </div>
    </nav>
    <header class="page-header header container-fluid">
        <div class="overlay"></div>
        <div class="description">
            <h1>Welcome to use our MVC Image Cloning!</h1>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque interdum quam odio, quis placerat ante luctus eu. Sed aliquet dolor id sapien rutrum, id vulputate quam iaculis. Suspendisse consectetur mi id libero fringilla, in pharetra sem ullamcorper.</p>
        <button class="btn btn-outline-secondary btn-lg" type="button" onclick="doScrolling('#step1', 500)">Try Now!</button>
        </div>
    </header>

    <div class="container features" id="step1">
        <!-- <p class="h1">Step #1: Upload Images</p> -->
        <div class="row">
            <div class="col">
                <h3 class="feature-title" style="text-align: center;">Upload Source Image</h3>
                <form action="/" enctype="multipart/form-data" method="post">
                <input type="file"
                    id="src_img"
                    class="filepond"
                    name="src_img"
                    accept="image/png, image/jpeg, image/gif"/>
                </form>
            </div>
            <div class="col">
                <h3 class="feature-title" style="text-align: center;">Upload Target Image</h3>
                <form action="/" enctype="multipart/form-data" method="post">
                <input type="file"
                    id="dst_img"
                    class="filepond"
                    name="dst_img"
                    accept="image/png, image/jpeg, image/gif"/>
                </form>
            </div>
        </div>
        <div class="row float-right mt-3 mb-3">
        <button class="btn btn-outline-success" id="to_step2" type="button" style="display: none;" onclick="doScrolling('#step2', 500)">Next Step &#8594;</button>
        </div>
    </div>
    <div class="container features" id="step2">
        <div class="row">
            <div class="col">
                <canvas id="jPolygon" width="{{ jpoly_width }}" height="{{ jpoly_height }}" 
                    style="cursor:crosshair" 
                    background="{{ url_for('upload_images', filename='src_upload.jpg') }}"
                    onmousedown="point_it(event)" oncontextmenu="return false;">
                    Your browser does not support the HTML5 canvas tag.
                </canvas>
            </div>
            <div class="col">
                <button onclick="undo()">Undo</button>
                <button onclick="clear_canvas()">Clear</button>
                <button onclick="send_vertices(); 
                    start_konva({{ konva_width }}, {{ konva_height }})">Done</button>
                <p>Press <strong>Left Click</strong> to draw a point.</p>
                <p><strong>CTRL+Click</strong> or <strong>Right Click</strong> to close the polygon.</p>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <p><strong>Coordinates:</strong></p>
                <textarea id="coordinates" disabled="disabled" style="width:300px; height:200px;"></textarea>
            </div>
            <div class="col">
                <div>
                    <div id="konva"></div>
                    <button onclick="finish_transform()">Done</button>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="{{ url_for('static', filename='filepond_upload.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='jPolygon.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='script.js') }}"></script>
    </body>
    
</html>
